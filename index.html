<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Court of Happiness ‚Äî Interactive</title>

<!-- Meta / Preview (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å) -->
<meta name="title" content="‚öñÔ∏è The Court of Happiness ‚Äî Interactive">
<meta name="description" content="–ú–∏–Ω–∏-–∏–≥—Ä–∞-–ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ: –°—É–¥—å—è –ê–ª—É–∞, —Å–≤–∏–¥–µ—Ç–µ–ª—å –ù—É—Ä–∞–ª–∏ –∏ –≤–µ—Ä–¥–∏–∫—Ç ‚Äî —Å—á–∞—Å—Ç—å–µ –∏ –∫–æ—Ñ–µ –Ω–∞–≤—Å–µ–≥–¥–∞.">
<meta property="og:type" content="website">
<meta property="og:title" content="‚öñÔ∏è –°—É–¥ —Å—á–∞—Å—Ç—å—è ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤">
<meta property="og:description" content="–ò–≥—Ä–æ–≤–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ê–ª—É–∞ –æ—Ç –ù—É—Ä–∞–ª–∏.">
<link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/thumb/3/39/Emblem_of_Kazakhstan_gold.svg/64px-Emblem_of_Kazakhstan_gold.svg.png">

<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@600&family=Inter:wght@400;600&family=Roboto+Mono&display=swap" rel="stylesheet">

<style>
  :root {
    --blue:#005fa3; --bg:#f7f9fb; --ink:#203041; --line:#d9e2ea; --gold:#caa04a; --ok:#2ea44f; --soft:#eef4f9;
  }
  * { box-sizing: border-box; }
  body {
    margin:0; background:linear-gradient(#fdfcf9, var(--bg));
    color:var(--ink); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  }
  header { text-align:center; padding:28px 16px 8px; }
  header img { width:88px; filter: drop-shadow(0 1px 0 rgba(0,0,0,.1)); }
  h1 { font-family:Merriweather, serif; margin:10px 0 2px; letter-spacing:.3px; }
  h2 { margin:4px 0 0; font-weight:500; color:var(--blue); }
  .sub { font-family:"Roboto Mono", monospace; font-size:.95rem; color:#526476; }

  .wrap { max-width:880px; margin:20px auto 64px; padding:0 16px; }
  .card {
    background:#fff; border:1.5px solid var(--line); border-radius:14px; padding:20px;
    box-shadow:0 8px 24px rgba(31,70,88,.06);
  }

  .progress {
    height:10px; background:var(--soft); border-radius:999px; overflow:hidden; margin:12px 0 20px;
    border:1px solid var(--line);
  }
  .bar { height:100%; width:0%; background:linear-gradient(90deg, var(--blue), #00a3ff); transition:width .6s ease; }

  .btn {
    appearance:none; border:0; background:var(--blue); color:#fff; padding:12px 18px;
    border-radius:10px; cursor:pointer; font-weight:600; box-shadow:0 4px 12px rgba(0,95,163,.2); transition:.2s;
  }
  .btn:hover { transform:translateY(-1px); }
  .btn.ghost { background:#fff; color:var(--blue); border:1.5px solid var(--blue); }
  .btn.row { width:100%; text-align:left; margin:8px 0; display:flex; align-items:center; gap:10px; }
  .kbd { background:#0f172a; color:#fff; padding:2px 8px; border-radius:6px; font-family:"Roboto Mono", monospace; font-size:.85rem; }

  .dialog { min-height:110px; line-height:1.6; }
  .say { margin:8px 0; padding:10px 12px; border-left:3px solid var(--line); background:#fff; border-radius:8px; }
  .role { font-weight:700; color:#0f3b5e; margin-right:6px; }
  .hint { font-size:.9rem; color:#5b6b7a; }

  .flex { display:flex; gap:16px; flex-wrap:wrap; }
  .half { flex:1 1 340px; }
  .panel { background:#fff; border:1.5px solid var(--line); border-radius:12px; padding:16px; }

  .evidence-grid {
    display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:8px;
  }
  .ev {
    user-select:none; text-align:center; border:1.5px dashed var(--line); padding:12px; border-radius:10px;
    cursor:pointer; background:#fbfdff; transition:.15s;
  }
  .ev.found { border-color:var(--ok); background:#f1fbf4; transform:scale(1.02); }
  .ev small { display:block; color:#778899; font-size:.8rem; }

  .verdict {
    display:none; margin-top:14px; background:#fff; border:2px solid var(--line); border-radius:12px; padding:22px;
  }
  .verdict h3 { margin:0 0 8px; font-family:Merriweather, serif; }
  .seal { text-align:right; font-style:italic; color:#4b5d6d; }

  .row-actions { display:flex; gap:10px; flex-wrap:wrap; margin:8px 0 2px; }
  .note { font-size:.9rem; color:#5b6b7a; margin-top:4px; }

  /* —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ */
  .gift {
    display:none; text-align:center; padding:12px; margin-top:10px;
  }
  .type { font-family:"Roboto Mono", monospace; white-space:pre-wrap; text-align:left; margin:18px auto; max-width:680px; }

  /* –ø–ª–∞–≤–∞—é—â–∏–µ —Å–µ—Ä–¥–µ—á–∫–∏ */
  .heart { position:fixed; bottom:-40px; font-size:22px; animation:float 6s linear forwards; pointer-events:none; }
  @keyframes float {
    from { transform:translateY(0) translateX(0) rotate(0deg); opacity:1; }
    to   { transform:translateY(-120vh) translateX(40px) rotate(20deg); opacity:0; }
  }
</style>
</head>
<body>
<header>
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/39/Emblem_of_Kazakhstan_gold.svg/256px-Emblem_of_Kazakhstan_gold.svg.png" alt="Emblem">
  <h1>THE COURT OF HAPPINESS</h1>
  <h2>–î–µ–ª–æ ‚Ññ2025-10-25: ¬´–ù–∞—Ä–æ–¥ –ø—Ä–æ—Ç–∏–≤ —Å–∫—É—á–Ω—ã—Ö –î–Ω–µ–π –†–æ–∂–¥–µ–Ω–∏—è¬ª</h2>
  <div class="sub">–ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É—é—â–∞—è —Å—É–¥—å—è: <b>–ê–ª—É–∞</b> ‚Ä¢ –°–≤–∏–¥–µ—Ç–µ–ª—å-—ç–∫—Å–ø–µ—Ä—Ç (Data Science): <b>–ù—É—Ä–∞–ª–∏</b></div>
</header>

<div class="wrap">
  <div class="card">
    <div class="progress" aria-label="–ü—Ä–æ–≥—Ä–µ—Å—Å">
      <div id="bar" class="bar"></div>
    </div>

    <!-- –°–¶–ï–ù–ê 1 ‚Äî –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ -->
    <section id="scene1">
      <div class="dialog">
        <div class="say"><span class="role">–°—É–¥—å—è –ê–ª—É–∞:</span> –ó–∞—Å–µ–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º. –ü—Ä–µ–¥–º–µ—Ç —Å–ª—É—à–∞–Ω–∏—è: –ø–æ—á–µ–º—É —Å–µ–≥–æ–¥–Ω—è –æ–±—è–∑–∞–Ω–æ –±—ã—Ç—å —Å–∞–º—ã–º —Å—á–∞—Å—Ç–ª–∏–≤—ã–º –¥–Ω—ë–º? üòâ</div>
        <div class="say"><span class="role">–ù—É—Ä–∞–ª–∏:</span> –ì–æ—Ç–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é: –≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∞—Ö –¥–µ–ª–∞ –≤–æ–∑–º–æ–∂–Ω—ã –∏–∑–ª–∏—à–∫–∏ –º–∏–ª–æ—Ç—ã –∏ –∫–æ—Ñ–µ.</div>
      </div>

      <div class="panel">
        <div class="hint">–í—ã–±–µ—Ä–∏—Ç–µ –ª–∏–Ω–∏—é –∑–∞—â–∏—Ç—ã (–º–æ–∂–Ω–æ –≤—Å–µ –ø–æ –æ—á–µ—Ä–µ–¥–∏):</div>
        <button class="btn row" data-choice="compliment">üìù –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏–º–µ–Ω–∏–Ω–Ω–∏—Ü—ã</button>
        <button class="btn row" data-choice="data">üìä Data-–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞</button>
        <button class="btn row" data-choice="human">üí¨ –ß–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å & –Ω–µ–±–æ–ª—å—à–∞—è –Ω–µ–ª–æ–≤–∫–æ—Å—Ç—å</button>

        <div id="choiceBox" class="note"></div>
      </div>

      <div class="row-actions">
        <button id="objection" class="btn ghost">‚ö° –í–æ–∑—Ä–∞–∂–µ–Ω–∏–µ!</button>
        <button id="order" class="btn ghost">üîî –ü–æ—Ä—è–¥–æ–∫ –≤ —Å—É–¥–µ</button>
        <button id="next1" class="btn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º ‚Üí</button>
      </div>
    </section>

    <!-- –°–¶–ï–ù–ê 2 ‚Äî –º–∏–Ω–∏-–∏–≥—Ä–∞ —Å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º–∏ -->
    <section id="scene2" style="display:none">
      <div class="flex">
        <div class="half panel">
          <div class="hint">–°–æ–±–µ—Ä–∏—Ç–µ 3 –∏–∑ 5 ‚Äú—É–ª–∏–∫‚Äù (–∫–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º):</div>
          <div id="grid" class="evidence-grid">
            <div class="ev" data-id="1">‚òï –≠—Å–ø—Ä–µ—Å—Å–æ-–∞–ªibi <small>–±–µ–∑ –∫–æ—Ñ–µ –¥–µ–Ω—å –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è</small></div>
            <div class="ev" data-id="2">üìö –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ-–ø—Ä–∞–≤–æ–≤–æ–π –∫–æ–¥ <small>–ª—é–±–∏–º—ã–π —Ä–∞–∑–¥–µ–ª ‚Äî ‚Äú—Ä–∞–¥–æ—Å—Ç—å‚Äù</small></div>
            <div class="ev" data-id="3">üòÇ –Æ–º–æ—Ä-–ø—Ä–µ—Ü–µ–¥–µ–Ω—Ç <small>—Å–º–µ—Ö –ø—Ä–æ—Ç–∏–≤ —Å–∫—É–∫–∏</small></div>
            <div class="ev" data-id="4">üìà –ò–Ω–¥–µ–∫—Å —Å—á–∞—Å—Ç—å—è <small>–Ω–µ–ø—Ä–∏–ª–∏—á–Ω–æ –≤—ã—Å–æ–∫</small></div>
            <div class="ev" data-id="5">üíå –ü–∏—Å—å–º–æ –æ—Ç –ù—É—Ä–∞–ª–∏ <small>–∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–∏–ª–æ–µ</small></div>
          </div>
          <div class="note" id="evNote">0/3 —Å–æ–±—Ä–∞–Ω–æ</div>
        </div>

        <div class="half panel">
          <div class="dialog" id="dialog2">
            <div class="say"><span class="role">–°—É–¥—å—è –ê–ª—É–∞:</span> –ù–∞–ø–æ–º–∏–Ω–∞—é: –±—ã—Å—Ç—Ä–æ, —á—ë—Ç–∫–æ –∏ —Å —É–ª—ã–±–∫–æ–π.</div>
            <div class="say"><span class="role">–ù—É—Ä–∞–ª–∏:</span> –ü—Ä–∏–º—É –Ω–∞ —Å–µ–±—è —Å–º–µ–ª–æ—Å—Ç—å –±—ã—Ç—å –æ–±–∞—è—Ç–µ–ª—å–Ω–æ —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–º.</div>
          </div>
          <div class="row-actions">
            <button id="btnCharm" class="btn ghost">üôÇ –£–±–µ–¥–∏—Ç—å —Å —É–ª—ã–±–∫–æ–π</button>
            <button id="btnNerd" class="btn ghost">ü§ì –£–π—Ç–∏ –≤ –≥—Ä–∞—Ñ–∏–∫–∏</button>
            <button id="btnCute" class="btn ghost">üêª –î–æ–±–∞–≤–∏—Ç—å –º–∏–ª–æ—Ç—ã</button>
          </div>
        </div>
      </div>

      <div style="margin-top:10px; display:flex; gap:10px; justify-content:flex-end;">
        <button id="back1" class="btn ghost">‚Üê –ù–∞–∑–∞–¥</button>
        <button id="next2" class="btn" disabled>–ö –æ–≥–ª–∞—à–µ–Ω–∏—é –ø—Ä–∏–≥–æ–≤–æ—Ä–∞ ‚Üí</button>
      </div>
    </section>

    <!-- –°–¶–ï–ù–ê 3 ‚Äî –ø—Ä–∏–≥–æ–≤–æ—Ä –∏ –ø–æ–¥–∞—Ä–æ–∫ -->
    <section id="scene3" style="display:none">
      <div class="verdict" id="verdictBox">
        <h3>‚öñÔ∏è –û–§–ò–¶–ò–ê–õ–¨–ù–´–ô –ü–†–ò–ì–û–í–û–†</h3>
        <p>
          –†–∞—Å—Å–º–æ—Ç—Ä–µ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–µ–ª–∞, –≤—ã—Å–ª—É—à–∞–≤ —Å–≤–∏–¥–µ—Ç–µ–ª—è-—ç–∫—Å–ø–µ—Ä—Ç–∞ –ù—É—Ä–∞–ª–∏ –∏ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –æ—Ü–µ–Ω–∏–≤ —É—Ä–æ–≤–µ–Ω—å —É–ª—ã–±–æ–∫ –°—É–¥—å–∏ –ê–ª—É–∞,
          –°—É–¥ —Å—á–∞—Å—Ç—å—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∏–ª:<br><br>
          ‚Ä¢ –ü—Ä–∏–∑–Ω–∞—Ç—å –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è <b>–ê–ª—É–∞</b> –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫—Ä—É–≥–∞ –±–ª–∏–∑–∫–∏—Ö –ª–∏—Ü;<br>
          ‚Ä¢ –ù–∞–∑–Ω–∞—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –Ω–æ—Ä–º—É –∫–æ—Ñ–µ –∏ –æ–±—ä—è—Ç–∏–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –º–µ—Ä—ã –æ—Ç —Å–∫—É–∫–∏;<br>
          ‚Ä¢ –£–ª—ã–±–∫–∞–º ‚Äî –±—ã—Ç—å, –¥–µ–¥–ª–∞–π–Ω–∞–º ‚Äî –ø–æ–¥–æ–∂–¥–∞—Ç—å, —Å—á–∞—Å—Ç—å—é ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤—Å—Ç—É–ø–∏—Ç—å –≤ —Å–∏–ª—É.
        </p>
        <div class="seal">–ü–µ—á–∞—Ç—å: ‚òÄ –†–µ—Å–ø—É–±–ª–∏–∫–∞ —Ä–∞–¥–æ—Å—Ç–∏ ‚Ä¢ –ü–æ–¥–ø–∏—Å–∏: –ê–ª—É–∞ / –ù—É—Ä–∞–ª–∏</div>
      </div>

      <div class="gift" id="gift">
        <button id="giftBtn" class="btn">üéÅ –û—Ç–∫—Ä—ã—Ç—å –ø–æ–¥–∞—Ä–æ–∫</button>
        <div id="giftMsg" class="type"></div>
        <div style="margin-top:10px;">
          <button id="replay" class="btn ghost" style="display:none">‚Ü∫ –ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</button>
        </div>
      </div>
    </section>

  </div>
</div>

<!-- libs -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
  // ===== –æ–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Å—Ü–µ–Ω/–ø—Ä–æ–≥—Ä–µ—Å—Å–∞ =====
  const bar = document.getElementById('bar');
  const S1 = document.getElementById('scene1');
  const S2 = document.getElementById('scene2');
  const S3 = document.getElementById('scene3');

  function setProgress(p){ bar.style.width = p + '%'; }

  // ===== –°—Ü–µ–Ω–∞ 1: –≤—ã–±–æ—Ä—ã –∏ –∂–∏–≤—ã–µ –æ—Ç–≤–µ—Ç—ã =====
  const choiceBox = document.getElementById('choiceBox');
  const starters = {
    compliment:
      "üìå –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞: –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–∞—è, –æ—Å—Ç—Ä–æ—É–º–Ω–∞—è, —É–º–µ–µ—Ç —Å–ø–æ—Ä–∏—Ç—å –ø–æ –¥–µ–ª—É –∏ –æ–±–Ω–∏–º–∞—Ç—å –ø–æ –¥–µ–ª—É —Ç–æ–∂–µ. –¢–æ—Ç —Å–∞–º—ã–π —á–µ–ª–æ–≤–µ–∫, —Ä—è–¥–æ–º —Å –∫–æ—Ç–æ—Ä—ã–º –¥–∞–∂–µ –∫–æ—Ñ–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –±—É–∫–µ—Ç.",
    data:
      "üìå Data-–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞: –º–æ–¥–µ–ª—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ –±—É—Å—Ç–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ 100% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–ª—ã–±–æ–∫. P-value ‚Äî —Å–º–µ—à–Ω–æ –º–∞–ª; –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª ‚Äî ¬´–º–º–º, –¥–∞¬ª.",
    human:
      "üìå –ß–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç—å: —è –≤–æ–ª–Ω—É—é—Å—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ—á–µ–Ω—å —Ö–æ—á—É, —á—Ç–æ–±—ã —Ç–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å. –ï—Å–ª–∏ —á—Ç–æ ‚Äî —É –º–µ–Ω—è –µ—Å—Ç—å –ø–ª–∞–Ω –ë: —à–æ–∫–æ–ª–∞–¥–∫–∞ –∏ –≥–ª—É–ø–∞—è —à—É—Ç–∫–∞."
  };

  document.querySelectorAll('#scene1 [data-choice]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const key = btn.dataset.choice;
      choiceBox.innerText = starters[key];
      bumpProgress(10);
    });
  });

  const objection = document.getElementById('objection');
  const order = document.getElementById('order');
  const next1 = document.getElementById('next1');

  objection.addEventListener('click', ()=>{
    toast("–í–æ–∑—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ. –ù–æ –ø—Ä–æ—Ç–∏–≤ —Ö–æ—Ä–æ—à–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –≤–æ–∑—Ä–∞–∂–∞—Ç—å... —Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è üòâ");
    bumpProgress(5);
  });
  order.addEventListener('click', ()=>{
    toast("üîî –ü–æ—Ä—è–¥–æ–∫ –≤ —Å—É–¥–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü–æ—Ä—è–¥–æ–∫ –≤ –º—ã—Å–ª—è—Ö ‚Äî –ø–æ—Å–ª–µ –∫–æ—Ñ–µ.");
    bumpProgress(5);
  });
  next1.addEventListener('click', ()=>{
    S1.style.display='none'; S2.style.display='block'; setProgress(40);
  });

  // ===== –°—Ü–µ–Ω–∞ 2: –º–∏–Ω–∏-–∏–≥—Ä–∞ =====
  const grid = document.getElementById('grid');
  const evNote = document.getElementById('evNote');
  const next2 = document.getElementById('next2');
  const dialog2 = document.getElementById('dialog2');
  const back1 = document.getElementById('back1');
  const btnCharm = document.getElementById('btnCharm');
  const btnNerd = document.getElementById('btnNerd');
  const btnCute = document.getElementById('btnCute');

  let collected = new Set();

  grid.querySelectorAll('.ev').forEach(card=>{
    card.addEventListener('click', ()=>{
      const id = card.dataset.id;
      if (!collected.has(id)) {
        collected.add(id);
        card.classList.add('found');
        evNote.textContent = `${collected.size}/3 —Å–æ–±—Ä–∞–Ω–æ`;
        bumpProgress(8);
        if (collected.size >= 3) {
          next2.disabled = false;
          toast("–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –°—É–¥ –ø—Ä–æ—Å–∏—Ç –ø–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–∏–≥–æ–≤–æ—Ä—É.");
        }
      } else {
        toast("–≠—Ç–∞ —É–ª–∏–∫–∞ —É–∂–µ –≤ –¥–µ–ª–µ üìÅ");
      }
    });
  });

  btnCharm.addEventListener('click', ()=> addLine("–ù—É—Ä–∞–ª–∏", "–í–∞—à–∞ —á–µ—Å—Ç—å, –æ–±–µ—â–∞—é –Ω–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π. –¢–æ–ª—å–∫–æ —Ñ–∞–∫—Ç: –≤—ã —É–º–µ–µ—Ç–µ –¥–µ–ª–∞—Ç—å –¥–Ω–∏ —Ç–µ–ø–ª–µ–µ."));
  btnNerd.addEventListener('click', ()=> addLine("–ù—É—Ä–∞–ª–∏", "–ï—Å–ª–∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏—é —Å—á–∞—Å—Ç—å—è –æ—Ç –æ–±—ä—ë–º–∞ –∫–æ—Ñ–µ, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏ '–ê–ª—É–∞' ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∑–Ω–∞—á–∏–º üòå"));
  btnCute.addEventListener('click', ()=> addLine("–°—É–¥—å—è –ê–ª—É–∞", "–ü—Ä–æ—Ç–æ–∫–æ–ª: –º–∏–ª–æ—Ç–∞ –∑–∞—Å—á–∏—Ç–∞–Ω–∞. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ, –Ω–æ –±–µ–∑ –ø–µ—Ä–µ–≥–∏–±–∞."));

  back1.addEventListener('click', ()=>{ S2.style.display='none'; S1.style.display='block'; setProgress(25); });
  next2.addEventListener('click', ()=>{
    S2.style.display='none'; S3.style.display='block'; setProgress(70);
    // –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≥–æ–≤–æ—Ä, –ø–æ—Ç–æ–º –ø–æ–¥–∞—Ä–æ–∫
    document.getElementById('verdictBox').style.display='block';
    setTimeout(()=> {
      document.getElementById('gift').style.display='block';
      setProgress(85);
    }, 800);
  });

  function addLine(role, text){
    const p = document.createElement('div');
    p.className='say';
    p.innerHTML = `<span class="role">${role}:</span> ${text}`;
    dialog2.appendChild(p);
    dialog2.scrollTop = dialog2.scrollHeight;
    bumpProgress(4);
  }

  // ===== –°—Ü–µ–Ω–∞ 3: –ø–æ–¥–∞—Ä–æ–∫ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π =====
  const giftBtn = document.getElementById('giftBtn');
  const giftMsg = document.getElementById('giftMsg');
  const replay = document.getElementById('replay');

  giftBtn.addEventListener('click', async ()=>{
    giftBtn.disabled = true;
    fireConfettiBurst();
    floatingHearts();
    await type(giftMsg,
`–ê–ª—É–∞, –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –≤–µ—Ä–¥–∏–∫—Ç –ø—Ä–æ—Å—Ç:

‚Ä¢ –°—á–∞—Å—Ç—å–µ ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é.
‚Ä¢ –ö–æ—Ñ–µ ‚Äî –ø–æ –ø–µ—Ä–≤–æ–º—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.
‚Ä¢ –£–ª—ã–±–∫–∏ ‚Äî –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.
‚Ä¢ –û–±—ä—è—Ç–∏—è ‚Äî unlimited.

–°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Ç—ã –µ—Å—Ç—å. 
‚Äî –ù—É—Ä–∞–ª–∏ ‚ù§Ô∏è`);
    setProgress(100);
    replay.style.display='inline-block';
  });

  replay.addEventListener('click', ()=>{
    window.scrollTo({top:0, behavior:'smooth'});
    // —Å–±—Ä–æ—Å
    collected.clear();
    document.querySelectorAll('.ev').forEach(e=>e.classList.remove('found'));
    evNote.textContent = '0/3 —Å–æ–±—Ä–∞–Ω–æ';
    choiceBox.textContent='';
    document.getElementById('giftMsg').textContent='';
    document.getElementById('gift').style.display='none';
    document.getElementById('verdictBox').style.display='none';
    next2.disabled = true; giftBtn.disabled=false;
    S3.style.display='none'; S1.style.display='block'; setProgress(0);
  });

  // ===== —É—Ç–∏–ª–∏—Ç—ã =====
  function bumpProgress(delta){
    const cur = parseInt(bar.style.width) || 0;
    const next = Math.min(100, cur + delta);
    setProgress(next);
  }

  function toast(msg){
    const el = document.createElement('div');
    el.textContent = msg;
    el.style.position='fixed';
    el.style.left='50%'; el.style.bottom='24px'; el.style.transform='translateX(-50%)';
    el.style.background='#0f172a'; el.style.color='#fff'; el.style.padding='10px 14px';
    el.style.borderRadius='10px'; el.style.boxShadow='0 6px 18px rgba(0,0,0,.25)';
    el.style.fontSize='.95rem'; el.style.zIndex=99; el.style.opacity='0';
    document.body.appendChild(el);
    requestAnimationFrame(()=>{ el.style.transition='opacity .2s'; el.style.opacity='1'; });
    setTimeout(()=>{ el.style.opacity='0'; setTimeout(()=>el.remove(), 200); }, 1800);
  }

  async function type(node, text){
    node.textContent='';
    for (let i=0;i<text.length;i++){
      node.textContent += text[i];
      await new Promise(r=>setTimeout(r, 20));
    }
  }

  function fireConfettiBurst(){
    for(let i=0;i<8;i++){
      confetti({ particleCount: 80, spread: 70, startVelocity: 45, origin: { y: 0.7, x: 0.5 } });
    }
  }

  function floatingHearts(){
    const emojis = ['üíô','üíõ','üíñ','üí´','‚ú®','üíô','üíõ','üíñ'];
    for(let i=0;i<24;i++){
      const s = document.createElement('div');
      s.className='heart'; s.textContent = emojis[i%emojis.length];
      s.style.left = (Math.random()*92+4) + 'vw';
      s.style.animationDuration = (4 + Math.random()*3)+'s';
      s.style.fontSize = (18 + Math.random()*14)+'px';
      document.body.appendChild(s);
      setTimeout(()=>s.remove(), 7000);
    }
  }
</script>
</body>
</html>
